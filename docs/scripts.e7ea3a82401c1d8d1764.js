var selectedGenes=[],decrease=[],increase=[],for_each_node=function(e,t,n){"use strict";var o;for(o=0;o<e.length;o+=1)t.call(n,e[o])},js_comm_globals={};function loadFloatingProteinWindowCoor(e,t,n,o,i,r,d){"use strict";var s=r-n/2;s<50&&(s=50);var a=d-30;a<20&&(a=30);var l=js_comm_globals.web_cgi_dir+"/showiteminfo?";l+="&noAction=1&search_string_link=1",l+="&node="+e,l+="&taskId="+js_comm_globals.task_id,l+="&referer=embedded_svg",l+="&node_type=P";var c=js_comm_globals.web_images_dir+"/loading_bigrotation.gif";return hideFloatingDiv("fpWindowDiv"),displayFloatingDiv("fpWindowDiv",i,n,o,-1,-1,s,a,"#E6E6E6",null,l,c),!1}function loadFloatingProteinWindow(e,t,n,o,i,r,d){"use strict";var s=0,a=0;if(d){var l=document.getElementById("stringEmbedded");if(l)s=(c=l.getBoundingClientRect()).left,a=c.top;var c,u=document.getElementById("network_object");if(u)s=(c=u.getBoundingClientRect()).left-s,a=c.top-a}return e.stopPropagation(),loadFloatingProteinWindowCoor(t,n,o,i,r,e.clientX+s,e.clientY+a)}function loadFloatingInteractionWindowCoor(e,t,n,o,i){}function edge_popup(e,t,n,o,i){}function toggle_structure_section(e,t){"use strict";var n="current.section.count."+t,o=document.getElementById(n),i="max.section.count."+t,r=document.getElementById(i),d=o.textContent,s=r.textContent,a=Number(d)+e;if(a>0&&a<=Number(s)){o.textContent=String(a);var l,c=1;for(c=1;c<=Number(s);c+=1)l="protein.section.group."+c,document.getElementById(l).style.visibility=c===a?"visible":"hidden";var u="domainoffset"+t+"r"+a,m=document.getElementById(u).textContent;document.getElementById("smart_domain_illustration_image").setAttribute("x",m)}return!0}function getSTRING(e,t,n,o,i){js_comm_globals.web_cgi_dir=e+/cgi/,js_comm_globals.web_images_dir=e+/images/,selectedGenes=n,decrease=i,increase=o;var r=document.getElementById("stringEmbedded"),d=new FormData(d);for(let e in t){let n=t[e];"identifiers"==e?(proteins_str=n.join("%0d"),d.append(e,proteins_str)):d.append(e,n)}var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState==XMLHttpRequest.DONE&&(r.innerHTML=s.responseText,init_network_interactive_functionalities(),update_network_coordinates_at_server=function(){})},s.open("POST",e+"/api/interactive_svg/network",!0),s.send(d)}function submit_current_network(){document.getElementById("string_embedded_linkout").submit()}function getSTRINGpost(e,t){js_comm_globals.web_cgi_dir=e+/cgi/,js_comm_globals.web_images_dir=e+/images/;var n=document.getElementById("stringEmbedded"),o=new FormData(o);for(let e in t){let n=t[e];o.append(e,n)}var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(n.innerHTML=i.responseText,init_network_interactive_functionalities(),update_network_coordinates_at_server=function(){})},i.open("POST",e+"/api/interactive_svg/network",!0),i.send(o)}js_comm_globals.session_id="",js_comm_globals.task_id="";var svgWidth=450,svgHeight=450,parent_document=null,network_document=null,network_offset_x=0,network_offset_y=0,svg_metainfo_nodes={},svg_network_positions_dirty=0;function setMovableNode(e){"use strict";e.has_moved=!1,e.is_in_front=!1,e.is_being_dragged=!1,e.original_event_target=null,e.onmousedown=moveObjectMDown,e.ontouchstart=moveObjectTDown,e.onmouseupCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectMUp.apply(e,arguments)},e.onmousemoveCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectMMove.apply(e,arguments)},e.ontouchendCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectTUp.apply(e,arguments)},e.ontouchmoveCallback=function(t){return e.original_event_target=t.currentTarget,moveObjectTMove.apply(e,arguments)}}function initiate_move(e,t,n){"use strict";e.movStartX=t,e.movStartY=n,e.movStartObject={x:e.node.x,y:e.node.y},e.has_moved=!1,e.is_in_front=!1,e.is_being_dragged=!0;var o=document.getElementById("network_object");if(o){var i=o.getBoundingClientRect();network_offset_x=i.left,network_offset_y=i.top}}function moveObjectMDown(e){return initiate_move(this,e.clientX,e.clientY),parent_document.addEventListener("mousemove",this.onmousemoveCallback,!1),parent_document.addEventListener("mouseup",this.onmouseupCallback,!1),parent_document!==network_document&&network_document.addEventListener("mousemove",this.onmousemoveCallback,!1),parent_document!==network_document&&network_document.addEventListener("mouseup",this.onmouseupCallback,!1),!1}function moveObjectMMove(e){"use strict";if(!this.is_being_dragged)return!1;if(this.is_in_front||(this.parentNode.appendChild(this),this.is_in_front=!0),0==svgHeight||0==svgWidth){var t=network_document.getElementById("svg_network_image");svgWidth=t.width,svgHeight=t.height}var n=e.clientX,o=e.clientY;parent_document!==network_document&&this.original_event_target==parent_document&&(n-=network_offset_x,o-=network_offset_y),this.original_event_target=null,n==this.movStartX&&o==this.movStartY||(this.has_moved=!0),this.node.x=this.movStartObject.x+n-this.movStartX,this.node.y=this.movStartObject.y+o-this.movStartY,this.node.x<this.node.radius/2?this.node.x=this.node.radius/2:this.node.x+this.node.radius/2>svgWidth&&(this.node.x=svgWidth-this.node.radius/2),this.node.y<this.node.radius/2?this.node.y=this.node.radius/2:this.node.y+this.node.radius/2>svgHeight&&(this.node.y=svgHeight-this.node.radius/2),this.setAttribute("transform","translate("+(this.node.x-this.node.ix)+","+(this.node.y-this.node.iy)+")");for(var i=0;i<this.node.links.length;++i){var r=this.node.links[i],d=r.n2.x-r.n1.x,s=r.n2.y-r.n1.y,a=Math.sqrt(d*d+s*s);0==a?(d=0,s=0):(d/=a,s/=a);var l=-s,c=d;r.elm.setAttribute("x1",r.n1.x+d*r.x1+l*r.y1),r.elm.setAttribute("y1",r.n1.y+s*r.x1+c*r.y1),r.elm.setAttribute("x2",r.n2.x+d*r.x2+l*r.y2),r.elm.setAttribute("y2",r.n2.y+s*r.x2+c*r.y2)}return svg_network_positions_dirty=1,!1}function moveObjectMUp(e){"use strict";return this.is_being_dragged=!1,parent_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),parent_document.removeEventListener("mouseup",this.onmouseupCallback,!1),parent_document!==network_document&&network_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),parent_document!==network_document&&network_document.removeEventListener("mouseup",this.onmouseupCallback,!1),!1}function moveObjectTDown(e){"use strict";if(0==e.targetTouches.length)return!0;e.preventDefault();var t=e.targetTouches[0];return this.touchId=t.identifier,e.clientX=t.clientX,e.clientY=t.clientY,initiate_move(this,e.clientX,e.clientY),parent_document.addEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document.addEventListener("touchend",this.ontouchendCallback,!1),parent_document!==network_document&&network_document.addEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document!==network_document&&network_document.addEventListener("touchend",this.ontouchendCallback,!1),!1}function moveObjectTMove(e){"use strict";e.preventDefault();for(var t=0;t<e.touches.length&&e.touches[t].identifier!=this.touchId;++t);if(t>=e.touches.length)return moveObjectTUp(e);var n=e.touches[t];return null==n||(e.clientX=n.clientX,e.clientY=n.clientY,moveObjectMMove.apply(this,arguments)),!1}function moveObjectTUp(e){"use strict";this.is_being_dragged=!1,parent_document.removeEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document.removeEventListener("touchend",this.ontouchendCallback,!1),parent_document!==network_document&&network_document.removeEventListener("touchmove",this.ontouchmoveCallback,!1),parent_document!==network_document&&network_document.removeEventListener("touchend",this.ontouchendCallback,!1);for(var t=0;t<e.changedTouches.length&&e.changedTouches[t].identifier!=this.touchId;++t);var n=e.changedTouches[t];return null==n||(e.clientX=n.clientX,e.clientY=n.clientY,handle_network_node_click.apply(this,arguments)),!1}function update_network_coordinates_at_server(e,t){"use strict";if(!svg_network_positions_dirty)return!1;svg_network_positions_dirty=0;var n=svgWidth+"#"+svgHeight+"#";for(var o in svg_metainfo_nodes){var i=svg_metainfo_nodes[o];n=n+o+":"+i.x+":"+i.y+"#"}var r={taskId:e,coordinates_info:n,timeout:t};if("undefined"!=typeof Worker){new Worker(js_comm_globals.web_js_dir+"/network_state_communication_worker_"+js_comm_globals.js_script_version+".js").postMessage(r)}else{var d=new XMLHttpRequest;d.open("POST",js_comm_globals.web_cgi_dir+"/updatenetworkcoordinates",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send("taskId="+r.taskId+"&node_coordinates="+r.coordinates_info)}updateCpnonceHash()}function handle_network_edge_click(e){"use strict";e.preventDefault();var t=this.id.split(".");hideFloatingDiv("fpWindowDiv"),edge_popup(e,t[1],t[2],"Interaction",!0),e.stopPropagation()}function handle_network_node_click(e){"use strict";if(!this.has_moved){var t=this.id.split(".")[1],n=this.getAttribute("data-action_option"),o=Number(this.getAttribute("data-exp_width")),i=Number(this.getAttribute("data-exp_height")),r=this.getAttribute("data-safe_div_label");hideFloatingDiv("fpWindowDiv"),loadFloatingProteinWindow(e,t,n,o,i,r,!0),e.stopPropagation()}}function init_network_interactive_functionalities(e){"use strict";var t=document.getElementById("network_object");if(t?(network_document=t.contentDocument,parent_document=document):(network_document=document,parent_document=network_document),network_document){var n=network_document.getElementById("svg_network_image");if(n){var o=n.getBoundingClientRect();svgWidth=o.width,svgHeight=o.height;var i=network_document.querySelectorAll(".nwnodecontainer");null!==i&&for_each_node(i,function(e){var t=e.id,n=e.getElementsByTagName("text");for(const e of n){var o=e.innerHTML.toUpperCase();selectedGenes.includes(o)&&e.setAttribute("font-weight","bold"),increase.includes(o)?e.setAttribute("fill","red"):decrease.includes(o)&&e.setAttribute("fill","blue")}svg_metainfo_nodes[t]={},svg_metainfo_nodes[t].elm=e,svg_metainfo_nodes[t].elm.node=svg_metainfo_nodes[t],svg_metainfo_nodes[t].x=Number(e.getAttribute("data-x_pos")),svg_metainfo_nodes[t].y=Number(e.getAttribute("data-y_pos")),svg_metainfo_nodes[t].radius=Number(e.getAttribute("data-radius")),svg_metainfo_nodes[t].ix=svg_metainfo_nodes[t].x,svg_metainfo_nodes[t].iy=svg_metainfo_nodes[t].y,svg_metainfo_nodes[t].links=[],setMovableNode(e),e.addEventListener("click",handle_network_node_click)});var r=network_document.querySelectorAll(".nwlinkwrapper");null!==r&&for_each_node(r,function(e){e.addEventListener("click",handle_network_edge_click)});var d=network_document.querySelectorAll(".nw_edge");null!==d&&for_each_node(d,function(e){var t=e.id.split("."),n="node."+t[1],o="node."+t[2],i={};i.n1=svg_metainfo_nodes[n],i.n2=svg_metainfo_nodes[o],i.elm=e,i.x1=Number(e.getAttribute("x1")),i.x2=Number(e.getAttribute("x2")),i.y1=Number(e.getAttribute("y1")),i.y2=Number(e.getAttribute("y2"));var r=i.x2-i.x1,d=i.y2-i.y1,s=Math.sqrt(r*r+d*d);0==s?(r=0,d=0):(r/=s,d/=s),r=Math.abs(r),d=Math.abs(d),i.n1.ix>i.n2.ix&&(r*=-1),i.n1.iy>i.n2.iy&&(d*=-1);var a,l,c=-d,u=r;i.x1-=i.n1.x,i.y1-=i.n1.y,a=i.x1*r+i.y1*d,l=i.x1*c+i.y1*u,i.x1=a,i.y1=l,i.x2-=i.n2.x,i.y2-=i.n2.y,a=i.x2*r+i.y2*d,l=i.x2*c+i.y2*u,i.x2=a,i.y2=l,i.n1.links.push(i),i.n2.links.push(i)}),window.setInterval(function(){update_network_coordinates_at_server(js_comm_globals.task_id,400)},1e3)}}}window.addEventListener("load",init_network_interactive_functionalities);var originalDivHtml={},hideDelaySeconds=-1,bfd_parent_document=null,bfd_network_document=null,bfd_network_offset_x=0,bfd_network_offset_y=0,objDiv=null,mouseDownOffsetX=0,mouseDownOffsetY=0;function displayFloatingDivImp(e,t,n,o,i,r,d,s,a,l){if("visible"!=document.getElementById(e).style.visibility){var c=-1;"number"==typeof window.pageYOffset?(window.pageYOffset,c=window.pageXOffset):document.body&&(document.body.scrollLeft||document.body.scrollTop)?(document.body.scrollTop,c=document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(document.documentElement.scrollTop,c=document.documentElement.scrollLeft);var u=1e4;"number"==typeof window.innerWidth?(u=window.innerWidth,window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(u=document.documentElement.clientWidth,document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(u=document.body.clientWidth,document.body.clientHeight),null!=n&&n>0&&(document.getElementById(e).style.width=n+"px"),null!=o&&o>0&&(document.getElementById(e).style.height=o+"px"),null!=i&&i>0&&(document.getElementById(e).style.left=i+"px"),null!=r&&r>0&&(document.getElementById(e).style.top=r+"px"),document.getElementById(e).style.zIndex=1e5;var m=document.getElementById(e).innerHTML;originalDivHtml[e]=m;var _="movable_div_resize_wrapper_"+e,v='<table class="movable_div_wrapper" id="'+_+'"><tr><td>',g="";if(null!=t)g='<table class="movable_div_title_container" style="background:'+d+';"><tr><td class="movable_div_title_bar" data-parent_div_to_move_id="'+e+'">'+t+'</td><td class="movable_div_closelink_wrapper"><a class="floatingdivcloselink" title="click to close" href="#" onclick="hideFloatingDiv(\''+e+'\');return false;"><img src="'+js_comm_globals.web_images_dir+'/floating_close_icon.png" width="16" height="16"/></a></td></tr></table>';document.getElementById(e).innerHTML=v+g+m+"</td></tr></table>",document.getElementById(e).style.display="block",document.getElementById(e).style.visibility="visible";var f=document.getElementById(e).offsetWidth;if(null!=n&&n>0&&(f=n),document.getElementById(_).style.width=f+"px",a){var p=i-(f-l)/2;p-c+f>u-20&&(p=c+u-(20+f)),p<20+c&&(p=20+c),Math.abs(p-i)>3&&(document.getElementById(e).style.left=p+"px")}initFloatingDivMovementOption(),null!==s&&s>0&&(timerDivId=e,hideDelaySeconds=s,startFDT())}}function displayFloatingDiv(e,t,n,o,i,r,d,s,a,l,c,u){null!=c&&""!=c&&ajaxCallForFD(e,t,i,r,d,s,a,l,c);var m=600;null!=n&&n>0&&(m=n);var _=350;null!=o&&o>0&&(_=o),null!=u&&""!=u&&(document.getElementById(e).innerHTML="<div style='width:"+m+"px;height:"+_+"px;display:table'><div style='text-align:center; display:table-cell; vertical-align:middle;'><img src='"+u+"' style='vertical-align: middle;'></img></div></div>"),displayFloatingDivImp(e,t,i,r,d,s,a,l)}function displayFloatingDivAjaxResponse(e,t,n,o,i,r,d,s,a){if(4==e.readyState&&200==e.status){var l=document.getElementById(t).offsetWidth;hideFloatingDiv(t),document.getElementById(t).innerHTML=e.responseText,displayFloatingDivImp(t,n,o,i,r,d,s,a,1,l)}}function ajaxCallForFD(e,t,n,o,i,r,d,s,a){var l=getRequestObject();if(l.onreadystatechange=function(){displayFloatingDivAjaxResponse(l,e,t,n,o,i,r,d,s)},a.length<=1024)l.open("GET",a,!0),l.send(null);else{var c=a.indexOf("?"),u=a.substr(c+1),m=a.substr(0,c);l.open("POST",m,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.setRequestHeader("Content-length",u.length),l.setRequestHeader("Connection","close"),l.send(u)}}function hideFloatingDiv(e){if(null!=e&&""!=e){var t=document.getElementById(e);null!=t&&"none"!=t.style.display&&(null!=originalDivHtml[e]&&(t.innerHTML=originalDivHtml[e]),t.style.visibility="hidden",t.style.display="none")}}function movable_div_initiate_move(e,t,n){"use strict";null!=e.parent_div_to_move&&(mouseDownOffsetX=t-parseInt(e.parent_div_to_move.style.left),mouseDownOffsetY=n-parseInt(e.parent_div_to_move.style.top));var o=document.getElementById("network_object");if(o){var i=o.getBoundingClientRect();bfd_network_offset_x=i.left,bfd_network_offset_y=i.top}}function movable_div_MDown_handler(e){"use strict";return movable_div_initiate_move(this,e.clientX,e.clientY),bfd_parent_document.addEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document.addEventListener("mouseup",this.onmouseupCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.addEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.addEventListener("mouseup",this.onmouseupCallback,!1),!1}function movable_div_MMove_handler(e){"use strict";if(null!==this.parent_div_to_move){var t=e.clientX-mouseDownOffsetX,n=e.clientY-mouseDownOffsetY;bfd_parent_document!==bfd_network_document&&e.currentTarget==bfd_network_document&&(t+=bfd_network_offset_x,n+=bfd_network_offset_y),this.parent_div_to_move.style.left=t+"px",this.parent_div_to_move.style.top=n+"px"}return!1}function movable_div_MUp_handler(e){"use strict";return bfd_parent_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document.removeEventListener("mouseup",this.onmouseupCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.removeEventListener("mousemove",this.onmousemoveCallback,!1),bfd_parent_document!==bfd_network_document&&bfd_network_document.removeEventListener("mouseup",this.onmouseupCallback,!1),!1}function movable_div_TDown_handler(e){"use strict";return!1}function movable_div_TMove_handler(e){"use strict";return!1}function movable_div_TUp_handler(e){"use strict";return!1}function registerMovableDivTitleBar(e){"use strict";e.has_moved=!1,e.is_being_dragged=!1,e.original_event_target=null,e.parent_div_to_move=null,e.hasAttribute("data-parent_div_to_move_id")&&(e.parent_div_to_move=document.getElementById(e.getAttribute("data-parent_div_to_move_id"))),e.onmousedown=movable_div_MDown_handler,e.ontouchstart=movable_div_TDown_handler,e.onmousemoveCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_MMove_handler.apply(e,arguments)},e.ontouchmoveCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_TMove_handler.apply(e,arguments)},e.onmouseupCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_MUp_handler.apply(e,arguments)},e.ontouchendCallback=function(t){return e.original_event_target=t.currentTarget,movable_div_TUp_handler.apply(e,arguments)}}function initFloatingDivMovementOption(){var e=document.getElementById("network_object");if(e?(bfd_network_document=e.contentDocument,bfd_parent_document=document):(bfd_network_document=document,bfd_parent_document=bfd_network_document),bfd_network_document){var t=bfd_parent_document.querySelectorAll(".movable_div_title_bar");null!==t&&for_each_node(t,function(e){registerMovableDivTitleBar(e)})}}var timerTimeSecondsFDT=0,timerIDFDT=0,tStartFDT=null,timerDivId=null;function updateTimerFDT(){timerIDFDT&&(clearTimeout(timerIDFDT),clockID=0),tStartFDT||(tStartFDT=new Date);var e=new Date,t=e.getTime()-tStartFDT.getTime();e.setTime(t),timerTimeSecondsFDT=e.getSeconds(),hideDelaySeconds<=timerTimeSecondsFDT&&(stopFDT(),hideFloatingDiv(timerDivId)),timerIDFDT=setTimeout("updateTimerFDT()",1e3)}function startFDT(){tStartFDT=new Date,timerTimeSecondsFDT=0,timerIDFDT=setTimeout("updateTimerFDT()",1e3)}function stopFDT(){timerIDFDT&&(clearTimeout(timerIDFDT),timerIDFDT=0),tStartFDT=null}function resetFDT(){tStartFDT=null,timerTimeSecondsFDT=0}function ajaxInsertInElement(e,t){var n=getRequestObject();n.onreadystatechange=function(){showResponseText(n,t)},n.open("GET",e,!0),n.send(null)}function ajaxSimpleCall(e){var t=getRequestObject();t.open("GET",e,!0),t.send(null)}function getRequestObject(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:null}function showResponseText(e,t){4==e.readyState&&200==e.status&&htmlInsert(t,e.responseText)}function htmlInsert(e,t){document.getElementById(e).innerHTML=t}